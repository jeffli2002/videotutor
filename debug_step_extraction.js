// è°ƒè¯•å®é™…çš„AIå“åº”æ ¼å¼
const actualAIResponse = `**é—®é¢˜åˆ†æ**  
è¿™æ˜¯ä¸€ä¸ªä¸€å…ƒä¸€æ¬¡ä¸ç­‰å¼çš„æ±‚è§£é—®é¢˜ï¼Œç›®æ ‡æ˜¯æ‰¾å‡ºæ»¡è¶³ä¸ç­‰å¼ $ 3x - 7 > 14 $ çš„æ‰€æœ‰å®æ•° $ x $ çš„å–å€¼èŒƒå›´ã€‚  
è§£é¢˜çš„åŸºæœ¬æ€è·¯æ˜¯é€šè¿‡ç§»é¡¹å’ŒåŒ–ç®€ï¼Œå°†ä¸ç­‰å¼è½¬åŒ–ä¸º $ x > a $ çš„å½¢å¼ï¼Œä»è€Œå¾—åˆ°è§£é›†ã€‚

---

**è¯¦ç»†è§£é¢˜æ­¥éª¤**

1. **æ­¥éª¤ç¼–å·ï¼š1**  
   **å…·ä½“æ“ä½œï¼šç§»é¡¹**  
   **è¯¦ç»†è§£é‡Šï¼šä¸ºäº†å°†æœªçŸ¥æ•° $ x $ å•ç‹¬ç•™åœ¨ä¸ç­‰å¼çš„ä¸€è¾¹ï¼Œæˆ‘ä»¬éœ€è¦å°†å¸¸æ•°é¡¹ $ -7 $ ç§»åˆ°ä¸ç­‰å·å³è¾¹ã€‚ç§»é¡¹æ—¶è¦å˜å·ã€‚**  
   **ä¸­é—´ç»“æœï¼š**  
   $
   3x - 7 > 14
   $  
   å°† $ -7 $ ç§»åˆ°å³è¾¹å˜ä¸º $ +7 $ï¼š  
   $
   3x > 14 + 7
   $  
   $
   3x > 21
   $

2. **æ­¥éª¤ç¼–å·ï¼š2**  
   **å…·ä½“æ“ä½œï¼šä¸¤è¾¹åŒæ—¶é™¤ä»¥3**  
   **è¯¦ç»†è§£é‡Šï¼šä¸ºäº†æ±‚å‡º $ x $ çš„å€¼ï¼Œéœ€è¦å°†ä¸¤è¾¹éƒ½é™¤ä»¥ $ x $ çš„ç³»æ•°3ã€‚å› ä¸º3æ˜¯æ­£æ•°ï¼Œä¸ç­‰å·æ–¹å‘ä¸å˜ã€‚**  
   **ä¸­é—´ç»“æœï¼š**  
   $
   \frac{3x}{3} > \frac{21}{3}
   $  
   $
   x > 7
   $`;

// æµ‹è¯•å½“å‰æå–é€»è¾‘
function debugStepExtraction(aiContent) {
  console.log('ğŸ” è°ƒè¯•æ­¥éª¤æå–...')
  console.log('è¾“å…¥é•¿åº¦:', aiContent.length)
  
  // 1. æ£€æŸ¥è¯¦ç»†æ­¥éª¤å—
  const detailBlockMatch = aiContent.match(/\*\*è¯¦ç»†è§£é¢˜æ­¥éª¤\*\*\s*([\s\S]*?)(?=\*\*æœ€ç»ˆç­”æ¡ˆ\*\*|$)/)
  if (detailBlockMatch) {
    console.log('âœ… æ‰¾åˆ°è¯¦ç»†æ­¥éª¤å—')
    const detailBlock = detailBlockMatch[1]
    console.log('è¯¦ç»†æ­¥éª¤å—é•¿åº¦:', detailBlock.length)
    console.log('è¯¦ç»†æ­¥éª¤å—å†…å®¹:')
    console.log(detailBlock.substring(0, 200) + '...')
    
    // 2. æµ‹è¯•ä¸åŒçš„æå–æ¨¡å¼
    const patterns = [
      // å½“å‰æ¨¡å¼
      /(\d+)[.ã€\)]\s*\*\*([^*]+?)\*\*\s*([\s\S]*?)(?=\n\s*\d+[.ã€\)]|\*\*|$)/g,
      // æ–°æ ¼å¼æ¨¡å¼
      /(\d+)[.ã€\)]\s*\*\*[^*]*?æ­¥éª¤ç¼–å·ï¼š(\d+)\*\*[^*]*?å…·ä½“æ“ä½œï¼š([^*]+?)\*\*[\s\S]*?(?=\n\d+[.ã€\)]|$)/g,
      // æ›´ç®€å•çš„æ¨¡å¼
      /(\d+)[.ã€\)]\s*([\s\S]*?)(?=\n\s*\d+[.ã€\)]|$)/g,
      // æ•è·æ•´ä¸ªæ®µè½
      /(\d+)[.ã€\)]\s*\*\*([^*]+?)\*\*\s*([\s\S]*?)(?=\n\d+[.ã€\)]|\*\*|$)/g,
      // æ•è·åˆ°ä¸‹ä¸€ä¸ªæ•°å­—
      /(\d+)[.ã€\)]\s*([\s\S]*?)(?=\n\d+[.ã€\)]|$)/g
    ]
    
    for (let i = 0; i < patterns.length; i++) {
      console.log(`\nğŸ§ª æµ‹è¯•æ¨¡å¼ ${i + 1}:`)
      const matches = [...detailBlock.matchAll(patterns[i])]
      console.log(`åŒ¹é…æ•°é‡: ${matches.length}`)
      
      if (matches.length > 0) {
        matches.forEach((match, idx) => {
          console.log(`  åŒ¹é… ${idx + 1}:`, {
            group1: match[1],
            group2: match[2] ? match[2].substring(0, 50) + '...' : 'N/A',
            group3: match[3] ? match[3].substring(0, 50) + '...' : 'N/A'
          })
        })
      }
    }
    
    // 3. å°è¯•æ›´ç®€å•çš„æå–
    console.log('\nğŸ§ª å°è¯•ç®€å•æå–:')
    const simplePattern = /(\d+)[.ã€\)]\s*([^\n]*(?:\n[^\n]*)*?)(?=\n\d+[.ã€\)]|$)/gm
    const simpleMatches = [...detailBlock.matchAll(simplePattern)]
    console.log(`ç®€å•æ¨¡å¼åŒ¹é…: ${simpleMatches.length}`)
    simpleMatches.forEach((match, idx) => {
      console.log(`  æ­¥éª¤ ${match[1]}: ${match[2].substring(0, 100)}...`)
    })
    
  } else {
    console.log('âŒ æœªæ‰¾åˆ°è¯¦ç»†æ­¥éª¤å—')
  }
  
  return []
}

// è¿è¡Œè°ƒè¯•
debugStepExtraction(actualAIResponse);